# CapsWriter-Offline (v2.0)

![image-20240108115946521](assets/image-20240108115946521.png)

> **æŒ‰ä½ CapsLock è¯´è¯ï¼Œæ¾å¼€å°±ä¸Šå±ã€‚å°±è¿™ä¹ˆç®€å•ã€‚**

CapsWriter-Offline æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨ç”µè„‘ä¸Šçš„**å®Œå…¨ç¦»çº¿**è¯­éŸ³è¾“å…¥å·¥å…·ã€‚

æ ¸å¿ƒåŠŸèƒ½å°±ä¸¤ä¸ªï¼š
1.  **è¯­éŸ³è¾“å…¥**ï¼šæŒ‰ä½ `å¤§å†™é”å®šé”®` (CapsLock) è¯´è¯ï¼Œæ¾å¼€æŒ‰é”®ï¼Œæ–‡å­—ç«‹åˆ»æ‰“è¿›å»ã€‚
2.  **æ–‡ä»¶è½¬å½•**ï¼šæŠŠéŸ³è§†é¢‘æ–‡ä»¶æ‹–è¿›çª—å£ï¼Œè‡ªåŠ¨ç”Ÿæˆå­—å¹•æ–‡ä»¶ã€‚

å®Œå…¨ç¦»çº¿ï¼Œä¸è”ç½‘ï¼Œæ•°æ®ä¸å‡ºæœ¬æœºï¼Œéšç§æœ‰ä¿éšœã€‚

---

## âœ¨ ä¸»è¦ç‰¹ç‚¹

-   **å®Œå…¨ç¦»çº¿**ï¼šæ‰€æœ‰æ¨¡å‹éƒ½åœ¨æœ¬åœ°è·‘ï¼Œæ‹”æ‰ç½‘çº¿ä¹Ÿèƒ½ç”¨ã€‚
-   **ä½å»¶è¿Ÿ**ï¼šåŸºäº WebSocketï¼Œè¯´å®Œæ¾æ‰‹ï¼Œå­—å°±å‡ºæ¥äº†ã€‚
-   **æ™ºèƒ½æ ¼å¼åŒ–**ï¼šè‡ªåŠ¨åŠ æ ‡ç‚¹ã€ä¸­æ–‡æ•°å­—è½¬é˜¿æ‹‰ä¼¯æ•°å­—ã€è°ƒæ•´ä¸­è‹±æ–‡é—´è·ã€‚
-   **çƒ­è¯æ›¿æ¢**ï¼šæ”¯æŒè‡ªå®šä¹‰æœ¯è¯­ã€äººåã€äº§å“åï¼ŒåŸºäºæ‹¼éŸ³æ¨¡ç³ŠåŒ¹é…ï¼Œå°±ç®—è¯´å¾—ä¸æ ‡å‡†ä¹Ÿèƒ½è®¤å‡ºæ¥ã€‚
-   **æ—¥è®°å½’æ¡£**ï¼šå¯ä»¥è‡ªåŠ¨æŠŠæ¯å¤©çš„è¯­éŸ³è®°å½•ä¿å­˜æˆ Markdown æ–‡ä»¶ï¼Œæ–¹ä¾¿æ—¥åæŸ¥é˜…ã€‚
-   **LLM æ¶¦è‰²ï¼ˆå¯é€‰ï¼‰**ï¼šå¯ä»¥æ¥å…¥æœ¬åœ°æˆ–åœ¨çº¿å¤§æ¨¡å‹ï¼Œå¯¹è¯†åˆ«ç»“æœè¿›è¡Œæ¶¦è‰²ã€ç¿»è¯‘ç­‰å¤„ç†ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### Windows ç”¨æˆ·ï¼ˆæ‡’äººåŒ…ï¼‰

1.  **ä¸‹è½½**ï¼šä» [GitHub Releases](https://github.com/HaujetZhao/CapsWriter-Offline/releases) ä¸‹è½½æ‰“åŒ…å¥½çš„å‹ç¼©åŒ…å’Œæ¨¡å‹ã€‚
2.  **è§£å‹**ï¼šæŠŠè½¯ä»¶å’Œæ¨¡å‹éƒ½è§£å‹å‡ºæ¥ï¼Œæ¨¡å‹æ”¾åˆ°è½¯ä»¶ç›®å½•ä¸‹çš„ `models` æ–‡ä»¶å¤¹é‡Œã€‚
3.  **å¯åŠ¨æœåŠ¡ç«¯**ï¼šåŒå‡» `start_server.exe`ï¼ˆä¼šå¼¹å‡ºä¸€ä¸ªé»‘çª—å£ï¼Œåˆ«å…³å®ƒï¼‰ã€‚
4.  **å¯åŠ¨å®¢æˆ·ç«¯**ï¼šåŒå‡» `start_client.exe`ï¼ˆæ‰˜ç›˜ä¼šå‡ºç°å›¾æ ‡ï¼‰ã€‚
5.  **å¼€å§‹ç”¨**ï¼šéšä¾¿æ‰¾ä¸ªèƒ½æ‰“å­—çš„åœ°æ–¹ï¼ŒæŒ‰ä½ `CapsLock` è¯´è¯ï¼Œæ¾å¼€å°±è¾“å…¥äº†ã€‚

> **ç³»ç»Ÿè¦æ±‚**ï¼šWindows 10 64ä½åŠä»¥ä¸Šï¼Œéœ€è¦å®‰è£… [VC++ è¿è¡Œåº“](https://learn.microsoft.com/zh-cn/cpp/windows/latest-supported-vc-redist)ã€‚

### æºç è¿è¡Œï¼ˆLinux / Mac / å¼€å‘è€…ï¼‰

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements-server.txt
pip install -r requirements-client.txt

# Linux è¿˜éœ€è¦è£… xclip
# sudo apt-get install xclip

# å¯åŠ¨
python core_server.py   # æœåŠ¡ç«¯
python core_client.py   # å®¢æˆ·ç«¯ï¼ˆLinux/Mac éœ€è¦ sudoï¼‰
```

> **Mac ç”¨æˆ·æ³¨æ„**ï¼šCapsLock åœ¨ Mac ä¸Šç›‘å¬æœ‰é—®é¢˜ï¼Œå»ºè®®åœ¨ `config.py` é‡ŒæŠŠå¿«æ·é”®æ”¹æˆ `right shift`ã€‚

---

## ğŸ¤ åŠŸèƒ½è¯¦è§£

### 1. è¯­éŸ³è¾“å…¥

æŒ‰ä½å¿«æ·é”®è¯´è¯ï¼Œæ¾å¼€å°±ä¸Šå±ã€‚é»˜è®¤å¿«æ·é”®æ˜¯ `CapsLock`ï¼Œå¯ä»¥åœ¨ `config.py` é‡Œæ”¹ã€‚

æ”¯æŒä¸¤ç§æ¨¡å¼ï¼š
-   **å¯¹è®²æœºæ¨¡å¼**ï¼ˆé»˜è®¤ï¼‰ï¼šæŒ‰ä½è¯´ï¼Œæ¾å¼€åœã€‚
-   **å½•éŸ³ç¬”æ¨¡å¼**ï¼šæŒ‰ä¸€ä¸‹å¼€å§‹å½•ï¼Œå†æŒ‰ä¸€ä¸‹åœæ­¢ã€‚

### 2. çƒ­è¯æ›¿æ¢

åœ¨ `hot.txt` é‡Œå†™ä¸Šä½ å¸¸ç”¨çš„ä¸“æœ‰åè¯ï¼ˆå…¬å¸åã€äººåã€äº§å“åç­‰ï¼‰ï¼Œä¸€è¡Œä¸€ä¸ªã€‚
ç¨‹åºä¼šåŸºäºæ‹¼éŸ³è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œå°±ç®—è¯­éŸ³è¯†åˆ«ç»“æœä¸å®Œå…¨å¯¹ï¼Œä¹Ÿèƒ½æ›¿æ¢æˆæ­£ç¡®çš„è¯ã€‚

å¦å¤–è¿˜æœ‰ï¼š
-   `hot-rule.txt`ï¼šè‡ªå®šä¹‰æ›¿æ¢è§„åˆ™ï¼Œæ ¼å¼æ˜¯ `åŸè¯ = æ›¿æ¢è¯`ï¼Œæ¯”å¦‚ `æ¯«å®‰æ—¶ = mAh`ã€‚
-   `hot-rectify.txt`ï¼šLLM çº é”™å†å²ï¼Œä¼šè‡ªåŠ¨è®°å½•å’Œå­¦ä¹ ã€‚

### 3. æ–‡ä»¶è½¬å½•

æŠŠéŸ³é¢‘æˆ–è§†é¢‘æ–‡ä»¶ç›´æ¥æ‹–åˆ°å®¢æˆ·ç«¯çª—å£ä¸Šï¼Œç¨‹åºä¼šè‡ªåŠ¨è½¬å½•å¹¶ç”Ÿæˆï¼š
-   `.srt` å­—å¹•æ–‡ä»¶
-   `.txt` çº¯æ–‡æœ¬
-   `.json` å¸¦æ—¶é—´æˆ³çš„è¯¦ç»†æ•°æ®

### 4. æ—¥è®°åŠŸèƒ½

å¼€å¯ `save_audio` åï¼Œæ¯æ¬¡è¯­éŸ³è¾“å…¥éƒ½ä¼šä¿å­˜å½•éŸ³å’Œè¯†åˆ«ç»“æœï¼ŒæŒ‰ `å¹´/æœˆ/æ—¥.md` çš„æ ¼å¼å½’æ¡£ã€‚
è¿˜å¯ä»¥åœ¨ `keywords.txt` é‡Œå®šä¹‰å…³é”®è¯ï¼Œæ¯”å¦‚"å¥åº·"ã€"å·¥ä½œ"ï¼Œè¯´è¯æ—¶ä»¥å…³é”®è¯å¼€å¤´ï¼Œå°±ä¼šå½’æ¡£åˆ°å•ç‹¬çš„æ–‡ä»¶é‡Œã€‚

### 5. LLM æ¶¦è‰²ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰

å¦‚æœä½ é…ç½®äº† LLMï¼ˆå¦‚æœ¬åœ° Ollama æˆ–åœ¨çº¿ APIï¼‰ï¼Œå¯ä»¥å¯¹è¯†åˆ«ç»“æœè¿›è¡ŒäºŒæ¬¡å¤„ç†ï¼š
-   å»é™¤å£è¯­åŒ–çš„è¯­æ°”è¯
-   ä¿®æ­£å¯èƒ½çš„é”™è¯¯
-   ç¿»è¯‘ã€æ”¹å†™ç­‰

åœ¨ `LLM/` æ–‡ä»¶å¤¹ä¸‹æœ‰è§’è‰²é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚
ä¸éœ€è¦è¿™ä¸ªåŠŸèƒ½çš„è¯ï¼Œåœ¨ `config.py` é‡ŒæŠŠ `llm_enabled` è®¾ä¸º `False` å°±è¡Œã€‚

---

## âš™ï¸ é…ç½®è¯´æ˜

æ‰€æœ‰é…ç½®éƒ½åœ¨ `config.py` é‡Œï¼Œå¸¸ç”¨çš„æœ‰ï¼š

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `shortcut` | è§¦å‘å½•éŸ³çš„å¿«æ·é”® | `caps lock` |
| `hold_mode` | é•¿æŒ‰æ¨¡å¼ï¼ˆTrueï¼‰è¿˜æ˜¯ç‚¹å‡»æ¨¡å¼ï¼ˆFalseï¼‰ | `True` |
| `save_audio` | æ˜¯å¦ä¿å­˜å½•éŸ³æ–‡ä»¶ | `True` |
| `hot` | æ˜¯å¦å¯ç”¨çƒ­è¯æ›¿æ¢ | `True` |
| `llm_enabled` | æ˜¯å¦å¯ç”¨ LLM æ¶¦è‰² | `True` |
| `model_type` | è¯­éŸ³è¯†åˆ«æ¨¡å‹ | `funasr_nano` |

### å…³äºæ¨¡å‹

-   **funasr_nano**ï¼ˆé»˜è®¤æ¨èï¼‰ï¼šå‡†ç¡®ç‡æœ€é«˜ï¼Œé€Ÿåº¦ä¹Ÿä¸é”™ã€‚
-   **sensevoice**ï¼šæ”¯æŒå¤šè¯­è¨€ï¼ˆä¸­è‹±æ—¥éŸ©ç²¤ï¼‰ï¼Œç»¼åˆä½“éªŒå¥½ã€‚
-   **paraformer**ï¼šè€ç‰ˆæœ¬ç”¨çš„ï¼Œç°åœ¨ä¸€èˆ¬ç”¨ä¸åˆ°äº†ã€‚

---

## ğŸ› ï¸ å¸¸è§é—®é¢˜

**Q: æŒ‰äº†æ²¡ååº”ï¼Ÿ**  
A: æ£€æŸ¥æœåŠ¡ç«¯æ˜¯ä¸æ˜¯åœ¨è¿è¡Œï¼Œå®¢æˆ·ç«¯æ‰˜ç›˜å›¾æ ‡è¿˜åœ¨ä¸åœ¨ã€‚

**Q: Mac ä¸Š CapsLock ä¸å¥½ä½¿ï¼Ÿ**  
A: åœ¨ `config.py` é‡ŒæŠŠ `shortcut` æ”¹æˆ `right shift`ã€‚

**Q: æƒ³éšè—é»‘çª—å£ï¼Ÿ**  
A: å¯ä»¥ç”¨ VBS è„šæœ¬å¯åŠ¨ï¼Œæˆ–è€…åˆ›å»ºå¿«æ·æ–¹å¼è®¾ç½®"æœ€å°åŒ–è¿è¡Œ"ã€‚

**Q: æƒ³å¼€æœºè‡ªå¯ï¼Ÿ**  
A: æŠŠå¿«æ·æ–¹å¼æ”¾åˆ° `shell:startup` æ–‡ä»¶å¤¹é‡Œã€‚

---

## ğŸ“¦ ä¸‹è½½åœ°å€

-   **GitHub Releases**ï¼š[https://github.com/HaujetZhao/CapsWriter-Offline/releases](https://github.com/HaujetZhao/CapsWriter-Offline/releases)
-   **ç™¾åº¦ç½‘ç›˜**ï¼šhttps://pan.baidu.com/s/1zNHstoWZDJVynCBz2yS9vg ï¼ˆæå–ç : eu4cï¼‰

> ç™¾åº¦ç›˜é“¾æ¥å¯èƒ½ä¼šå¤±æ•ˆï¼ŒGitHub ä¸‹è½½æœ€å¯é ã€‚

---

## â¤ï¸ è‡´è°¢

æœ¬é¡¹ç›®ä½¿ç”¨äº†ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š
-   [Sherpa-ONNX](https://github.com/k2-fsa/sherpa-onnx)
-   [FunASR](https://github.com/alibaba-damo-academy/FunASR)

å¦‚æœè§‰å¾—å¥½ç”¨ï¼Œæ¬¢è¿æ‰“èµæ”¯æŒï¼š

![sponsor](assets/sponsor.jpg)